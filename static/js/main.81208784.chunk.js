(this["webpackJsonpfestival-poster-app"]=this["webpackJsonpfestival-poster-app"]||[]).push([[0],{45:function(t,e,n){t.exports=n.p+"static/media/city.7878fa91.jpg"},46:function(t,e,n){t.exports=n.p+"static/media/fireworks.c1f1ed0c.jpg"},49:function(t,e,n){t.exports=n(75)},54:function(t,e,n){},55:function(t,e,n){},65:function(t,e,n){},66:function(t,e,n){},75:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),i=n(16),c=n.n(i),o=(n(54),n(55),n(7)),s=n(6),u=n.n(s),l=n(22),f=n(19),h=n(12),p=n(17),d=n(14),v=n(18),m=n(48),b=function(t){var e=t instanceof y?t.type:null;return{message:t.message,name:t.name,stack:t.stack,type:e}},y=function(t){function e(t,n){var r;return Object(d.a)(this,e),(r=Object(f.a)(this,Object(h.a)(e).call(this,t)))._type=null,n&&(r._type=n),r}return Object(p.a)(e,t),Object(v.a)(e,[{key:"toJSON",value:function(){return b(this)}},{key:"type",get:function(){return this._type},set:function(t){this._type=t}}]),e}(Object(m.a)(Error)),w="https://api.spotify.com",g="v1",E=function(){function t(e){Object(d.a)(this,t),this.apiKey=e}return Object(v.a)(t,[{key:"getPlaylistArtists",value:function(t){var e;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.a.awrap(this.getPlaylistTracks(t));case 2:if(!((e=n.sent)instanceof y)){n.next=5;break}return n.abrupt("return",e);case 5:return n.abrupt("return",R(e));case 6:case"end":return n.stop()}}),null,this)}},{key:"noAuthAPICall",value:function(t){var e,n;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u.a.awrap(fetch(t));case 3:return e=r.sent,r.next=6,u.a.awrap(j(e,t));case 6:return n=r.sent,r.abrupt("return",n);case 10:return r.prev=10,r.t0=r.catch(0),r.abrupt("return",r.t0);case 13:case"end":return r.stop()}}),null,null,[[0,10]])}}]),t}(),x=function(t){function e(){return Object(d.a)(this,e),Object(f.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(v.a)(e,[{key:"getPlaylists",value:function(){return t=this.apiKey,u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",T(t,["me","playlists"]));case 1:case"end":return e.stop()}}));var t}},{key:"getPlaylistTracks",value:function(t){return function(t,e){var n;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.a.awrap(T(t,["playlists",e,"tracks"]));case 2:if(!((n=r.sent)instanceof y)){r.next=5;break}return r.abrupt("return",n);case 5:return r.abrupt("return",n.map((function(t){return t.track})));case 6:case"end":return r.stop()}}))}(this.apiKey,t)}},{key:"me",value:function(){return u.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",C(this.apiKey));case 1:case"end":return t.stop()}}),null,this)}},{key:"topArtists",value:function(){var t,e,n,r,a,i,c,o,s=arguments;return u.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},e=t.limit,n=void 0===e?"50":e,r=t.offset,a=void 0===r?"0":r,i=t.time_range,c=void 0===i?"medium_term":i,l.next=3,u.a.awrap(T(this.apiKey,["me","top","artists"],{limit:n,offset:a,time_range:c}));case 3:return o=l.sent,l.abrupt("return",o);case 5:case"end":return l.stop()}}),null,this)}}]),e}(E),k=function(t){function e(){return Object(d.a)(this,e),Object(f.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(v.a)(e,[{key:"getPlaylists",value:function(){var t;return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t=O("users",this.apiKey,"playlists"),e.next=3,u.a.awrap(this.noAuthAPICall(t));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),null,this)}},{key:"getPlaylistTracks",value:function(t){var e;return u.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=O("playlists",this.apiKey,"tracks"),t.next=3,u.a.awrap(this.noAuthAPICall(e));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),null,this)}},{key:"me",value:function(){var t;return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t=O("users",this.apiKey),e.next=3,u.a.awrap(this.noAuthAPICall(t));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),null,this)}}]),e}(E);function O(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[g].concat(e).join("/");return new URL(r,w).href}function j(t,e){var n;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.ok){r.next=4;break}if(401!==t.status){r.next=3;break}return r.abrupt("return",new y("Fetch for URL ".concat(e," returned not ok status.  Status: ").concat(t.status),"NoSpotifyAccess"));case 3:return r.abrupt("return",new y("Fetch for URL ".concat(e," returned not ok status.  Status: ").concat(t.status),"NoSpotifyAccess"));case 4:if(200===t.status){r.next=6;break}return r.abrupt("return",new y("Fetch for URL ".concat(e," returned a status of ").concat(t.status),"NoSpotifyAccess"));case 6:return r.prev=6,r.next=9,u.a.awrap(t.json());case 9:return n=r.sent,r.abrupt("return",n);case 13:return r.prev=13,r.t0=r.catch(6),r.abrupt("return",r.t0);case 16:case"end":return r.stop()}}),null,null,[[6,13]])}function A(t,e){var n,r;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n={Authorization:"Bearer ".concat(t)},a.prev=1,a.next=4,u.a.awrap(fetch(e,{headers:n}));case 4:return r=a.sent,a.abrupt("return",j(r,e));case 8:return a.prev=8,a.t0=a.catch(1),a.abrupt("return",a.t0);case 11:case"end":return a.stop()}}),null,null,[[1,8]])}function S(t){if(!t)return"";var e=new URLSearchParams;for(var n in t)e.append(n,t[n]);return e.toString()}function T(t,e,n){var r,a,i;return u.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return r=S(n),a=O.apply(void 0,Object(l.a)(e).concat(["?".concat(r)])),c.next=4,u.a.awrap(A(t,a));case 4:if(!((i=c.sent)instanceof y)){c.next=7;break}return c.abrupt("return",i);case 7:if(i.hasOwnProperty("items")){c.next=9;break}throw new y("Returned paging object does not contain items field.  Url: ".concat(a));case 9:return c.abrupt("return",i.items);case 10:case"end":return c.stop()}}))}function C(t){var e,n;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=O("me"),r.next=3,u.a.awrap(A(t,e));case 3:return n=r.sent,r.abrupt("return",n);case 5:case"end":return r.stop()}}))}function R(t){var e=new Set;return t.forEach((function(t){e.add(t.artists[0].name)})),Object(l.a)(e)}var N=n(8),_=n(11),I=n(21),P=n(15),U=Object(I.b)({name:"system",initialState:{spotifyAccessToken:"",spotifyAccessTokenExpire:"",error:{isError:!1}},reducers:{accessTokenUpdated:function(t,e){return Object(P.a)(t,(function(t){t.spotifyAccessToken=e.payload.spotifyAccessToken,t.spotifyAccessTokenExpire=e.payload.spotifyAccessTokenExpire,""!==e.payload.spotifyAccessToken&&t.error.isError&&"NoSpotifyAccess"===t.error.error.type&&(t.error={isError:!1})}))},caughtGlobalError:function(t,e){return Object(P.a)(t,(function(t){t.error={isError:!0,error:b(e.payload)}}))},clearGlobalError:function(t){return Object(P.a)(t,(function(t){t.error={isError:!1}}))}}}),F=U.actions,L=F.accessTokenUpdated,D=F.caughtGlobalError,B=(F.clearGlobalError,U.reducer),z=.8*window.innerHeight,H={artists:[],themeType:"theme1",topArtistsTimeRange:"medium_term",width:.65*z,height:z},M=Object(I.b)({name:"poster",initialState:H,reducers:{changeThemeType:function(t,e){return Object(P.a)(t,(function(t){t.themeType=e.payload}))},updateArtistList:function(t,e){return Object(P.a)(t,(function(t){t.artists=e.payload}))},topArtistsTimeRangeUpdated:function(t,e){return Object(P.a)(t,(function(t){t.topArtistsTimeRange=e.payload}))}}}),G=M.actions,K=G.changeThemeType,X=G.updateArtistList,J=G.topArtistsTimeRangeUpdated,Z=M.reducer,W=Object(_.combineReducers)({poster:Z,system:B}),Y=function(t){return Object(N.c)(t)},V=function(){var t=Y((function(t){return t.system.spotifyAccessToken})),e=Y((function(t){return t.system.spotifyAccessToken}));if(""===t&&""===e)return{status:"NONE"};if(""===t||""===e)throw new Error("Spotify access token/expire in invalid state");return parseInt(e,10)<Math.floor(Date.now()/1e3)?{status:"EXPIRED"}:{status:"VALID",accessToken:t}},$=n(29),q=n(28),Q=n(77),tt=n(78),et=n(79),nt=n(90),rt=n(80),at=n(76),it=function(t){var e=t.children,n=Object(q.a)(t,["children"]),r=n.color?n.color:"primary",i=n.size?n.size:"sm";return a.a.createElement(at.a,Object.assign({color:r,size:i,onClick:function(t){var e;t.stopPropagation(),null===(e=n.onClick)||void 0===e||e.call(n,t)}},n),e)};n(65);function ct(t,e,n){t.preventDefault(),n(e)}var ot=function(t){var e=t.rowNumber,n=t.disableActions,i=t.item,c=t.isEditing,s=t.setIsEditing,u=Object(q.a)(t,["rowNumber","disableActions","item","isEditing","setIsEditing"]),l=Object(r.useState)(i.text),f=Object(o.a)(l,2),h=f[0],p=f[1],d=u.handleRemove,v=u.handleEdit,m=u.handleSelectionChange,b=u.canEditGlobal&&i.canEdit&&v,y=!(!u.canRemove||!d),w=!(!u.canSelect||void 0===m),g=!!i.isSelected;return c?a.a.createElement(Q.a,null,a.a.createElement(tt.a,null,a.a.createElement(et.a,{value:h,style:{display:"inline"},onChange:function(t){p(t.target.value)}}),a.a.createElement(nt.a,{addonType:"append"},a.a.createElement(it,{onClick:function(t){ct(t,ft(i,{text:h}),v),p(""),s(!1)}},"Save")),a.a.createElement(nt.a,{addonType:"append"},a.a.createElement(it,{color:"danger",onClick:function(t){p(""),s(!1)}},"X")))):function(){var t=w&&g;return a.a.createElement(Q.a,{key:i.text,action:w,active:t,className:"noselect d-flex justify-content-between align-items-center py-1",onClick:function(t){var e;return null===(e=u.handleSelectionChange)||void 0===e?void 0:e.call(u,i)}},"".concat(e+1,". "),i.text,a.a.createElement(rt.a,null,b&&v&&a.a.createElement(it,{disabled:n,onClick:function(t){return s(!0)}},"Edit"),y&&d&&a.a.createElement(it,{disabled:n,onClick:function(t){ct(t,i,d)}},"Remove")),t?"\u2705":"\u274c")}()},st=n(81),ut=-1,lt=function(){return++ut};function ft(t,e){return Object($.a)({id:lt()},t,{},e)}function ht(t,e,n){return{handleRemove:function(n){var r;t((function(t){return t.filter((function(t){return t.id!==n.id}))})),null===e||void 0===e||null===(r=e.handleRemove)||void 0===r||r.call(e,n)},handleAddRow:function(r){var a,i,c=(null===n||void 0===n?void 0:null===(a=n.addRow)||void 0===a?void 0:a.call(n,r))||r;t((function(t){return[].concat(Object(l.a)(t),[c])})),null===e||void 0===e||null===(i=e.handleAddRow)||void 0===i||i.call(e,c)},handleEdit:function(n){var r;t((function(t){var e=Object(l.a)(t),r=e.find((function(t){return t.id===n.id}));if(!r)throw new Error("Could not find edited item: ".concat(JSON.stringify(n)));return r.text=n.text,e})),null===e||void 0===e||null===(r=e.handleEdit)||void 0===r||r.call(e,n)},handleSelectionChange:function(n){t((function(t){return Object(P.a)(t,(function(t){var r,a=t.findIndex((function(t){return t.id===n.id}));t[a].isSelected=!n.isSelected,null===e||void 0===e||null===(r=e.handleSelectionChange)||void 0===r||r.call(e,t[a])}))}))},handleSelectAll:function(){t((function(t){var e=t.map((function(t){return Object($.a)({},t,{isSelected:!0})})),r=null===n||void 0===n?void 0:n.selectAll;return r&&(e=r(e)),e}))},handleClear:function(){t((function(t){var e=t.map((function(t){return Object($.a)({},t,{isSelected:!1})})),r=null===n||void 0===n?void 0:n.clear;return r&&(e=r(e)),e}))}}}var pt=function(t){var e=Object(r.useState)(!1),n=Object(o.a)(e,2),i=n[0],c=n[1],s=Object(r.useState)(""),u=Object(o.a)(s,2),l=u[0],f=u[1],h=Object(r.useState)(!1),p=Object(o.a)(h,2),d=p[0],v=p[1],m=t.items,b=t.canSelect&&t.handleSelectAll,y=t.canSelect&&t.handleClear,w=function(){var e=t.handleAddRow,n=t.canAddRow;return e&&n?i?a.a.createElement("div",null,a.a.createElement(Q.a,null,a.a.createElement(tt.a,null,a.a.createElement(et.a,{value:l,onChange:function(t){return f(t.target.value)}}),a.a.createElement(rt.a,null,a.a.createElement(it,{onClick:function(){var t=ft({text:l,userAdded:!0,isSelected:!1},{});c(!1),e(t),f("")}},"Save"),a.a.createElement(it,{color:"danger",onClick:function(){c(!1),f("")}},"X"))))):a.a.createElement(Q.a,null,a.a.createElement(it,{block:!0,disabled:d,onClick:function(){return c(!0)}},"Add Row")):null},g=function(){return a.a.createElement("div",{className:"list__header",style:{display:"flex",justifyContent:"space-between"}},t.name?a.a.createElement("h3",null,t.name):null,function(){var e=null,n=null;return b&&(e=a.a.createElement(it,{color:"success",onClick:function(e){var n;null===(n=t.handleSelectAll)||void 0===n||n.call(t)}},"Select All")),y&&(n=a.a.createElement(it,{color:"warning",onClick:function(e){var n;null===(n=t.handleClear)||void 0===n||n.call(t)}},"Unselect All")),a.a.createElement("div",{className:"list__actions"},a.a.createElement(rt.a,null,e,n))}())};return a.a.createElement("div",{className:"list"},function(){var e=m.map((function(e,n){return a.a.createElement(ot,Object.assign({key:e.id,item:e,setIsEditing:v,isEditing:d,disableActions:i,rowNumber:n},t))}));return a.a.createElement("div",{className:"list"},g(),a.a.createElement(st.a,null,e,w()))}())},dt=function(){var t=Object(N.b)();return Object(r.useCallback)((function(e,n){n&&(e.type=n),t(D(e))}),[t])},vt=function(){var t=V(),e=dt(),n="";"NONE"===t.status||"EXPIRED"===t.status?e(new y("Spotify Access token status not valid.  status: ".concat(t.status)),"NoSpotifyAccess"):n=t.accessToken;return Object(r.useMemo)((function(){return""===n?null:function(t){var e=t.authToken,n=t.userId;return e&&""!==e?new x(e):n&&""!==n?new k(n):null}({authToken:n})}),[n])},mt=0,bt=function(){var t=Y((function(t){return t.poster.topArtistsTimeRange})),e=Y((function(t){return t.poster.artists})),n=vt(),a=Object(N.b)(),i=Object(r.useCallback)((function(t){console.log(t)}),[]),c=dt();return Object(r.useEffect)((function(){n&&function(){var e,r;u.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(null===n||void 0===n?void 0:n.topArtists){o.next=2;break}throw new Error("Expected topArtists method to exist on spotify api object");case 2:if(!(++mt>5)){o.next=5;break}throw new Error("Max Count Reached");case 5:return i("Using api to retreive top Artists for range "+t),o.prev=6,o.next=9,u.a.awrap(n.topArtists({time_range:t}));case 9:e=o.sent,o.next=15;break;case 12:o.prev=12,o.t0=o.catch(6),c(o.t0,"NoSpotifyAccess");case 15:if(o.prev=15,e){o.next=18;break}throw new y("Expected top artists data");case 18:if(!(e instanceof Error)){o.next=21;break}return c(e),o.abrupt("return");case 21:return r=e.map((function(t){return ft({isSelected:!0,text:t.name,canEdit:!1,userAdded:!1})})),a(X(r)),o.finish(15);case 24:case"end":return o.stop()}}),null,null,[[6,12,15,24]])}()}),[a,i,c,n,t]),{topArtists:e,setTopArtistsTimeRange:function(t){a(J(t))}}},yt=function(t,e,n){var a=Object(r.useState)(e),i=Object(o.a)(a,2),c=i[0],s=i[1];return[c,{options:t,selected:c,handleChange:function(t){s(t),n&&n(t)}}]},wt=function(t){var e=t.options,n=t.handleChange,r=t.selected,i=e.map((function(t){return a.a.createElement("option",{key:t.value,value:t.value},t.text)}));return a.a.createElement("select",{value:r,onChange:function(t){n&&n(t.target.value)}},i)},gt=n(45),Et=n.n(gt),xt=n(46),kt=n.n(xt),Ot=function(t,e,n){var r=t.getContext("2d");if(!r)throw new Error("Could not get canvas context to create HiDPI canvas");var a=function(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}(r);return t.width=e*a,t.height=n*a,t.style.width=e+"px",t.style.height=n+"px",r.setTransform(a,0,0,a,0,0),t},jt=function(){function t(e){Object(d.a)(this,t),this.ps=e,this.ctx=void 0,this.w=900,this.h=600,this.bgImage="",this.festivalNameText="My Festival",this.festivalNameColor="white",this.festivalNameFont="serif",this.festivalNameFontRatio=.1,this.festivalNameCase="upper",this.artistSeperator="/",this.artistFont="serif",this.artistColor="white",this.artistFontRatio=.025,this.artistTopRatio=.5,this.artistCase="upper"}return Object(v.a)(t,[{key:"getContext",value:function(t){var e=t.getContext("2d");if(!e)throw new y("Expected canvas context");return e}},{key:"setPosterSize",value:function(t,e){this.w=t,this.h=e}},{key:"drawBGImage",value:function(t){var e=Math.max(this.w/t.width,this.h/t.height),n=this.w/2-t.width/2*e,r=this.h/2-t.height/2*e;this.ctx.drawImage(t,n,r,t.width*e,t.height*e)}},{key:"font",value:function(t,e){return"".concat(this.fontHeight(t),"px ").concat(e)}},{key:"fontHeight",value:function(t){return Math.floor(t*this.h)}},{key:"cutTrailingChar",value:function(t){return t.slice(0,t.length-1)}},{key:"artistLines",value:function(){var t=[],e="",n=!0,r=!1,a=void 0;try{for(var i,c=this.artists[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){var o=i.value.text;"upper"===this.artistCase&&(o=o.toUpperCase()),Math.ceil(this.ctx.measureText(e+o).width)>this.w?(t.push(this.cutTrailingChar(e)),e=o+this.artistSeperator):e=e+o+this.artistSeperator}}catch(s){r=!0,a=s}finally{try{n||null==c.return||c.return()}finally{if(r)throw a}}return""!==e&&t.push(this.cutTrailingChar(e)),t}},{key:"drawFestivalName",value:function(){var t=this.w/2;this.ctx.font=this.font(this.festivalNameFontRatio,this.festivalNameFont),this.ctx.fillStyle=this.festivalNameColor,this.ctx.textBaseline="top",this.ctx.textAlign="center",this.ctx.strokeStyle="black",this.ctx.lineWidth=2,this.ctx.fillText(this.festivalName,t,30),this.ctx.strokeText(this.festivalName,t,30)}},{key:"drawArtistBlock",value:function(){var t=this,e=this.h*this.artistTopRatio;this.ctx.font=this.font(this.artistFontRatio,this.artistFont);var n=this.artistLines();this.ctx.textBaseline="top",this.ctx.textAlign="center",this.ctx.fillStyle=this.artistColor;var r=this.fontHeight(this.artistFontRatio);n.forEach((function(n,a){var i=e+(a+1)*r;t.ctx.fillText(n,t.midX,i,t.w)}))}},{key:"draw",value:function(t){var e=this;this.ctx=this.getContext(t),t.width=this.w,t.height=this.h,Ot(t,this.w,this.h);var n=new Image(this.w,this.h);n.onload=function(){e.drawBGImage(n),e.drawFestivalName(),e.drawArtistBlock()},n.src=this.bgImage}},{key:"midX",get:function(){return Math.floor(this.w/2)}},{key:"midY",get:function(){return Math.floor(this.h/2)}},{key:"festivalName",get:function(){return"upper"===this.festivalNameCase?this.festivalNameText.toUpperCase():this.festivalNameText}},{key:"artists",get:function(){return this.ps.artists.filter((function(t){return t.isSelected}))}}]),t}(),At=function(t){function e(){var t,n;Object(d.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(f.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(a)))).bgImage=kt.a,n.festivalNameFont="Impact",n.festivalNameColor="tomato",n.artistColor="lightblue",n.artistSeperator=String.fromCharCode(8226),n.artistTopRatio=.4,n}return Object(p.a)(e,t),e}(jt),St=function(t){function e(){var t,n;Object(d.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(f.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(a)))).bgImage=Et.a,n.festivalNameColor="lime",n.festivalNameFont="Avant Garde",n.artistColor="lime",n.artistFontRatio=.02,n.artistTopRatio=.7,n}return Object(p.a)(e,t),e}(jt);var Tt,Ct=function(){var t=function(){var t=Object(r.useState)([0,0]),e=Object(o.a)(t,2),n=e[0],a=e[1];return Object(r.useLayoutEffect)((function(){function t(){a([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",t),t(),function(){return window.removeEventListener("resize",t)}}),[]),n}(),e=Object(o.a)(t,2)[1],n=Math.floor(.8*e);return[Math.floor(.7*n),n]},Rt=[{text:"Last 6 Months",value:"medium_term"},{text:"All Time",value:"long_term"},{text:"1 Month",value:"short_term"}],Nt=function(){var t=Ct(),e=Object(o.a)(t,2)[1],n=bt().setTopArtistsTimeRange,i=Y((function(t){return t.poster.topArtistsTimeRange})),c=yt(Rt,i,(function(t){return n(t)})),s=Object(o.a)(c,2)[1],u=function(t,e){var n=Object(N.c)(t),a=Object(N.b)(),i=Object(r.useCallback)((function(t){a(e(t))}),[a,e]),c=ht((function(t){var r=t(n);a(e(r))}));return{items:n,setItems:i,listProps:c}}((function(t){return t.poster.artists}),X),l=u.items,f=u.listProps;return a.a.createElement("div",null,a.a.createElement("h3",{style:{display:"inline-block"}},"Top Artists"),a.a.createElement(wt,s),a.a.createElement("div",{style:{maxHeight:e,overflowY:"scroll"}},a.a.createElement(pt,Object.assign({items:l},f,{canSelect:!0}))))},_t=n(82),It=n(83),Pt=n(84),Ut=n(85),Ft=(n(66),function(t){t.themeType;var e=function(){var t,e=Ct(),n=Object(o.a)(e,2),r=n[0],a=n[1],i=Y((function(t){return t.poster}));switch(i.themeType){case"theme1":t=new At(i);break;case"theme2":t=new St(i);break;default:throw new y("Invalid theme ".concat(i.themeType))}return t.setPosterSize(r,a),t}(),n=Object(r.useRef)(null);Object(r.useEffect)((function(){var t=n.current;if(!t)throw new Error("Unable to retreive poster canvas element");e.draw(t)}));return a.a.createElement("canvas",{ref:n,id:"poster",style:{border:"3px solid"}},"Festival Poster Viewer")}),Lt=[{text:"Theme 1",value:"theme1"},{text:"Theme 2",value:"theme2"}],Dt=function(){return null},Bt=function(){var t=Object(N.b)(),e=Y((function(t){return t.poster.themeType})),n=yt(Lt,e,(function(e){t(K(e))})),r=Object(o.a)(n,2)[1];return a.a.createElement("div",{className:"home"},a.a.createElement(_t.a,{className:"navbar navbar-expand-sm navbar-light bg-light py-0",style:{marginBottom:"10px"}},a.a.createElement("div",{className:"navbar-brand"},"Poster App"),Dt()),a.a.createElement(It.a,null,a.a.createElement(Pt.a,null,a.a.createElement(Ut.a,null,a.a.createElement(wt,r),a.a.createElement(it,{color:"warning",onClick:function(){return function(){var t,e,n;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=document.getElementById("poster")){r.next=3;break}throw new Error("Expected canvas node");case 3:e=t.toDataURL("image/jpeg",1),null===(n=window.open("_blank"))||void 0===n||n.document.write('<img src="'.concat(e,'"></img>'));case 6:case"end":return r.stop()}}))}()}},"Create Image"),a.a.createElement(Ft,{themeType:e})),a.a.createElement(Ut.a,null,a.a.createElement(Nt,null)))))},zt=n(88),Ht="https://accounts.spotify.com/authorize",Mt="access_token",Gt="token_type",Kt="expires_in",Xt={client_id:"f775b626d4784dfba4491742d5453d55",response_type:"token",redirect_uri:"http://localhost:3000",scope:"user-top-read"};function Jt(){for(var t=[],e=0,n=Object.entries(Xt);e<n.length;e++){var r=n[e],a=Object(o.a)(r,2),i=a[0],c=a[1];t.push("".concat(i,"=").concat(c))}var s=t.join("&");return"".concat(Ht,"?").concat(s)}function Zt(){if(Tt)return{status:"AUTHORIZED",data:Tt};var t={},e=window.location.href.split("#");if(2!==e.length)return{status:"NOT_AUTHORIZED"};var n=e[1].split("&"),r=!0,a=!1,i=void 0;try{for(var c,s=n[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var u=c.value.split("="),l=Object(o.a)(u,2),f=l[0],h=l[1];t[f]=h}}catch(d){a=!0,i=d}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}if(t.hasOwnProperty("error"))return{status:"ACCESS_DENIED"};var p="";return t.hasOwnProperty(Mt)||(p="Hash fragment does not contain field: ".concat(Mt)),t.hasOwnProperty(Kt)||(p="Hash fragment does not contain field: ".concat(Kt)),t.hasOwnProperty(Gt)||(p="Hash fragment does not contain field: ".concat(Gt)),""!==p?{status:"ERROR",error:p}:{status:"AUTHORIZED",data:t}}var Wt=function(){return a.a.createElement(zt.b,{to:"/"})},Yt=function(){var t=Object(N.b)(),e=Zt();if("AUTHORIZED"!==e.status)return console.log("Non Authorized status: ".concat(e.status)),console.log(e.error),Wt();if(!e.data)throw new Error("Received authorized status without data");var n=e.data,r=n.access_token,a=n.expires_in;return t(L({spotifyAccessToken:r,spotifyAccessTokenExpire:a})),Wt()},Vt=function(){var t=Object(N.b)(),e=Zt();if("AUTHORIZED"!==e.status);else{if(!e.data)throw new Error("Received authorized status without data");var n=e.data,r=n.access_token,i=n.expires_in;window.location.hash="",t(L({spotifyAccessToken:r,spotifyAccessTokenExpire:i}))}return a.a.createElement("div",{className:"App"},a.a.createElement(zt.d,null,a.a.createElement(zt.c,{exact:!0,path:"/authenticate"},a.a.createElement(Yt,null)),a.a.createElement(zt.c,{exact:!0,path:"/"},a.a.createElement(Bt,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var $t=window.localStorage.getItem("__REDUX_LOCAL_STORAGE_KEY"),qt=$t?JSON.parse($t):void 0,Qt=[function(t){return function(e){return function(n){var r=e(n),a=t.getState(),i=JSON.stringify(a);return window.localStorage.setItem("__REDUX_LOCAL_STORAGE_KEY",i),r}}}],te=Object(I.a)({reducer:W,preloadedState:qt,middleware:Qt}),ee=n(89),ne=n(86),re=n(87),ae=function(t){var e=t.toggle;return a.a.createElement(ee.a,Object.assign({},t,{className:"spotify-auth-refresh-modal"}),a.a.createElement(ne.a,{toggle:e},"Spotify Is Asking To Be Authorized"),a.a.createElement(re.a,null,a.a.createElement("a",{href:Jt()},"Authorize Spotify")))},ie=function(t){var e=t.children,n=Y((function(t){return t.system.error})),i=Object(r.useState)(!1),c=Object(o.a)(i,2),s=c[0],u=c[1];if(!n.isError||!n.error)return s&&u(!1),a.a.createElement(a.a.Fragment,null,e);var l,f=n.error;if(console.log("isError: ".concat(n.isError,", error: ").concat(!!f,", errorData.error: ").concat(!!n.error)),f)switch(h.type){case"NoSpotifyAccess":s||u(!0),l=null;break;default:var h=n.error;l=a.a.createElement("h3",null,"Error"),console.error(h)}return a.a.createElement(a.a.Fragment,null,a.a.createElement(ae,{isOpen:s,toggle:function(){return u(!s)}}),l,e)};c.a.render(a.a.createElement(N.a,{store:te},a.a.createElement(ie,null,a.a.createElement(zt.a,null,a.a.createElement(Vt,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[49,1,2]]]);
//# sourceMappingURL=main.81208784.chunk.js.map