(this["webpackJsonpfestival-poster-app"]=this["webpackJsonpfestival-poster-app"]||[]).push([[0],{51:function(t,e,n){t.exports=n.p+"static/media/desert.1f4ebc63.png"},52:function(t,e,n){t.exports=n.p+"static/media/punk.ae35ea3b.png"},53:function(t,e,n){t.exports=n.p+"static/media/metal.78fbcaff.png"},54:function(t,e,n){t.exports=n.p+"static/media/galaxy.5fd0b3a6.png"},55:function(t,e,n){t.exports=n.p+"static/media/portrait_placeholder.4788048f.png"},67:function(t,e,n){t.exports=n(98)},68:function(t,e,n){},69:function(t,e,n){},74:function(t,e,n){},76:function(t,e,n){},86:function(t,e,n){},87:function(t,e,n){},95:function(t,e,n){},96:function(t,e,n){},98:function(t,e,n){"use strict";n.r(e);n(68),n(69);var a,r=n(0),i=n.n(r),s=n(23),o=n.n(s),c=(n(74),n(8)),u=n(118),l=n(119),h=n(107),f=n(108),d=n(5),p=n.n(d),m=(n(76),n(13)),v=n(11),g=n(12),b=n(10),y=n(16),k=n(65),w=function(t){var e=t instanceof x?t.type:null;return{message:t.message,name:t.name,stack:t.stack,type:e}},x=function(t){function e(t,n){var a;return Object(b.a)(this,e),(a=Object(m.a)(this,Object(v.a)(e).call(this,t)))._type=null,n&&(a._type=n),a}return Object(g.a)(e,t),Object(y.a)(e,[{key:"toJSON",value:function(){return w(this)}},{key:"type",get:function(){return this._type},set:function(t){this._type=t}}]),e}(Object(k.a)(Error)),E=n(19),O=n(24),j=n(20),S=Object(O.b)({name:"system",initialState:{spotifyAccessToken:"",spotifyAccessTokenExpire:"",error:{isError:!1}},reducers:{accessTokenUpdated:function(t,e){return Object(j.a)(t,(function(t){t.spotifyAccessToken=e.payload.spotifyAccessToken,t.spotifyAccessTokenExpire=e.payload.spotifyAccessTokenExpire,""!==e.payload.spotifyAccessToken&&t.error.isError&&"NoSpotifyAccess"===t.error.error.type&&(t.error={isError:!1})}))},caughtGlobalError:function(t,e){return Object(j.a)(t,(function(t){t.error={isError:!0,error:w(e.payload)}}))},clearGlobalError:function(t){return Object(j.a)(t,(function(t){t.error={isError:!1}}))}}}),A=S.actions,C=A.accessTokenUpdated,P=A.caughtGlobalError,R=(A.clearGlobalError,S.reducer),T=n(22),N=n(32),F={me:null,artists:[],topArtistsTimeRange:"medium_term",layoutType:"basic",themeType:"desert",festivalName:"My Festival",showDates:!0,date1:{date:"FRIDAY APRIL 10"},date2:{date:"SATURDAY APRIL 11"},date3:{date:"SUNDAY APRIL 12"},showPresentedBy:!0,presentedBy:"Presented by Red Bull",headliners:[[],[],[]]},I=Object(O.b)({name:"poster",initialState:F,reducers:{mergePoster:function(t,e){return Object(T.a)({},t,{},e.payload)},changeThemeType:function(t,e){t.themeType=e.payload},changeFestivalName:function(t,e){t.festivalName=e.payload},changeLayoutType:function(t,e){t.layoutType=e.payload},artistAdded:function(t,e){t.artists.unshift(e.payload)},updateArtistList:function(t,e){t.artists=e.payload,t.headliners=[[],[],[]]},artistRemoved:function(t,e){var n=e.payload.name,a=function(t){return t===n};t.artists=t.artists.filter((function(t){return t.data.name!==n})),t.headliners.forEach((function(e,n){var r=e.findIndex(a);r>-1&&t.headliners[n].splice(r,1)}))},mergeArtistList:function(t,e){return Object(T.a)({},t,{artists:Object(N.unionBy)(t.artists,e.payload,(function(t){return t.data.name}))})},moveArtist:function(t,e){var n=e.payload,a=n.from,r=n.to;if(a!==r){var i=t.artists[a];a<r?(t.artists.splice(r+1,0,i),t.artists.splice(a,1)):(t.artists.splice(a,1),t.artists.splice(r,0,i))}},updateMeData:function(t,e){},topArtistsTimeRangeUpdated:function(t,e){t.topArtistsTimeRange=e.payload},headlinerChanged:function(t,e){var n=e.payload,a=n.line,r=n.pos,i=n.newHeadliner;t.headliners[a][r]=i},headlinerRemoved:function(t,e){var n=e.payload,a=n.line,r=n.pos;t.headliners[a].splice(r,1)}}}),H=I.actions,B=H.changeThemeType,L=H.updateArtistList,D=(H.topArtistsTimeRangeUpdated,H.changeLayoutType),_=(H.updateMeData,H.mergeArtistList),M=H.changeFestivalName,z=H.mergePoster,U=H.artistRemoved,W=H.moveArtist,Y=H.headlinerChanged,X=(H.headlinerRemoved,H.artistAdded),V=I.reducer,K=Object(O.b)({name:"sidenav",initialState:{isOpen:!1,selectedOption:0},reducers:{sideNavSelectionChange:function(t,e){return Object(j.a)(t,(function(t){t.selectedOption=e.payload}))},setSideNavOpen:function(t,e){return Object(j.a)(t,(function(t){t.isOpen=e.payload}))},toggleSideNav:function(t){return Object(j.a)(t,(function(t){t.isOpen=!t.isOpen}))}}}),G=K.actions,J=G.sideNavSelectionChange,Z=(G.setSideNavOpen,G.toggleSideNav),$=K.reducer,q=n(9),Q=Object(E.combineReducers)({poster:V,system:R,sidenav:$}),tt=function(t){return Object(q.c)(t)},et=function(t,e,n){var a=t.getContext("2d");if(!a)throw new Error("Could not get canvas context to create HiDPI canvas");var r=function(t){var e=window.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return Math.ceil(e/n)}(a);return t.width=e*r,t.height=n*r,t.style.width=e+"px",t.style.height=n+"px",a.setTransform(r,0,0,r,0,0),t},nt=n(51),at=n.n(nt),rt=n(52),it=n.n(rt),st=n(53),ot=n.n(st),ct=n(54),ut=n.n(ct),lt=n(55),ht=n.n(lt),ft=function(t){function e(){return Object(b.a)(this,e),Object(m.a)(this,Object(v.a)(e).apply(this,arguments))}return Object(g.a)(e,t),e}(function(){function t(e,n,a,r){Object(b.a)(this,t),this.fontType=e,this.fontColor=n,this.fontSizeRatio=a,this.strokeInfo=void 0,this.strokeInfo=r||{strokeStyle:"black",widthRatio:.2,offsetX:0,offsetY:0}}return Object(y.a)(t,[{key:"setStrokeCtx",value:function(t,e,n,a){t.strokeStyle=e.strokeStyle,t.lineWidth=this.fontLineWidth(e.widthRatio,n)*a}},{key:"setTextCtx",value:function(t){t.fillStyle=this.fontColor}},{key:"draw",value:function(t,e,n,a,r,i){var s=this,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=Array.isArray(this.strokeInfo)?this.strokeInfo:[this.strokeInfo];r.save(),c.forEach((function(c){s.setStrokeCtx(r,c,i,o),r.strokeText(t,e+c.offsetX,n+c.offsetY,a)})),r.restore(),r.save(),this.setTextCtx(r),r.fillText(t,e,n,a),r.restore()}},{key:"fontHeight",value:function(t){return Math.floor(this.fontSizeRatio*t)}},{key:"fontString",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.fontHeight(t);return"".concat(n*e,"px ").concat(this.fontType)}},{key:"fontLineWidth",value:function(t,e){return t*this.fontHeight(e)}},{key:"maxStrokeSize",value:function(t){return this.maxStrokeRatio*this.fontHeight(t)}},{key:"lineHeight",value:function(t){return this.fontHeight(t)+this.maxStrokeSize(t)}},{key:"maxStrokeRatio",get:function(){if(!this.strokeInfo)return 0;var t=Array.isArray(this.strokeInfo)?this.strokeInfo:[this.strokeInfo],e=0;return t.forEach((function(t){e=Math.max(e,t.widthRatio+Math.abs(t.offsetY))})),e}}]),t}()),dt=function t(){Object(b.a)(this,t),this.backgroundImage="",this.sideMarginRatio=0,this.festivalNameTopRatio=.05,this.artistTopRatio=.4,this.skewText=!1,this.nameFontPkg=void 0,this.artistFontPkg=void 0,this.dateFontPkg=void 0},pt=function(t){function e(){var t,n;Object(b.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(t=Object(v.a)(e)).call.apply(t,[this].concat(r)))).backgroundImage=at.a,n.sideMarginRatio=.03,n.artistTopRatio=.3,n.nameFontPkg=new ft("TexasTango","orange",.08),n.artistFontPkg=new ft("WesternBangBang","orange",.032),n.dateFontPkg=new ft("WesternBangBang","orange",.032),n}return Object(g.a)(e,t),e}(dt),mt=function(t){function e(){var t,n;Object(b.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(t=Object(v.a)(e)).call.apply(t,[this].concat(r)))).backgroundImage=it.a,n.nameFontPkg=new ft("WesternBangBang","#37C3E1",.1),n.artistFontPkg=new ft("WesternBangBang","#37C3E1",.033),n.dateFontPkg=new ft("WesternBangBang","#37C3E1",.033),n}return Object(g.a)(e,t),e}(dt),vt=function(t){function e(){var t,n;Object(b.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(t=Object(v.a)(e)).call.apply(t,[this].concat(r)))).backgroundImage=ot.a,n.sideMarginRatio=.035,n.nameFontPkg=new ft("MadridGrunge","#7C7170",.1),n.artistFontPkg=new ft("PunkrockerStamp","#7C7170",.032),n.dateFontPkg=new ft("PunkrockerStamp","#7C7170",.032),n}return Object(g.a)(e,t),e}(dt),gt=function(t){function e(){var t,n;Object(b.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(t=Object(v.a)(e)).call.apply(t,[this].concat(r)))).backgroundImage=ut.a,n.festivalNameTopRatio=.05,n.artistFont="Monteral",n.artistColor="white",n.nameFontPkg=new ft("Cocogoose","white",.1,{widthRatio:.1,offsetX:0,offsetY:0,strokeStyle:"black"}),n.artistFontPkg=new ft("Monteral","white",.02),n.dateFontPkg=new ft("Monteral","white",.02),n.sideMarginRatio=.055,n}return Object(g.a)(e,t),e}(dt),bt=function(t){function e(){var t,n;Object(b.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(t=Object(v.a)(e)).call.apply(t,[this].concat(r)))).backgroundImage=ut.a,n.festivalNameTopRatio=.05,n.sideMarginRatio=.055,n.nameFontPkg=new ft("Cocogoose","white",.1),n.artistFontPkg=new ft("Monteral","lime",.02,[{strokeStyle:"yellow",widthRatio:.4,offsetX:0,offsetY:0},{strokeStyle:"blue",widthRatio:.2,offsetX:0,offsetY:0}]),n.dateFontPkg=n.artistFontPkg,n.skewText=!0,n}return Object(g.a)(e,t),e}(dt),yt=function(){function t(e,n,a,r){Object(b.a)(this,t),this.ctx=e,this.poster=n,this.text=a,this.fontPkg=r,this.x=void 0,this.y=void 0,this.scale=1}return Object(y.a)(t,[{key:"draw",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",a=this.ctx,r=this.fontPkg,i=this.poster,s=this.text,o=t<i.maxLeft?i.maxLeft:t;a.save(),this.setup(),a.textAlign=n,r.draw(s,o,e,1e4,a,i.h,this.scale),a.restore()}},{key:"drawLeft",value:function(t){var e=this.poster;this.draw(e.maxLeft,t,"left")}},{key:"drawRight",value:function(t){var e=this.poster;this.draw(e.maxRight,t,"right")}},{key:"setup",value:function(){this.ctx.font=this.fontPkg.fontString(this.poster.h,this.scale)}},{key:"lineHeight",get:function(){return this.fontPkg.fontHeight(this.poster.h)*this.scale}},{key:"metrics",get:function(){this.ctx.save(),this.setup();var t=this.ctx.measureText(this.text);return this.ctx.restore(),{width:t.width,height:this.lineHeight}}}]),t}(),kt=function(){function t(e){Object(b.a)(this,t),this._poster=e,this.dateCount=void 0,this.headlinerLineCount=void 0}return Object(y.a)(t,[{key:"fontPkg",value:function(t){switch(t){case"artist":return this.theme.artistFontPkg;case"name":return this.theme.nameFontPkg;case"date":return this.theme.dateFontPkg}}},{key:"cutTrailingChar",value:function(t){return t.slice(0,t.length-1)}},{key:"calculateTextWidth",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];var r=n.reduce((function(t,e){return t+e}),""),i=this.ctx.measureText(r);return Math.ceil(i.width+2*t.maxStrokeSize(this.posterHeight))}},{key:"setArtistFont",value:function(){this.ctx.font=this.fontPkg("artist").fontString(this.posterHeight)}},{key:"artistLines",value:function(){var t=[],e=this.poster,n=this.fontPkg("artist");this.setArtistFont();var a="",r=!0,i=!1,s=void 0;try{for(var o,c=this.poster.artistNames[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var u=o.value;this.calculateTextWidth(n,a,u)>this.maxPosterWidth?(t.push(this.cutTrailingChar(a)),a=u+e.artistSeperator):a=a+u+e.artistSeperator}}catch(l){i=!0,s=l}finally{try{r||null==c.return||c.return()}finally{if(i)throw s}}return""!==a&&t.push(this.cutTrailingChar(a)),t}},{key:"drawArtistBlock",value:function(t){var e=this,n=this.poster.canvasCtx,a=t||this.artistTop,r=this.artistLines();n.textBaseline="top",n.textAlign="center";var i=this.fontPkg("artist").lineHeight(this.posterHeight),s=0;r.forEach((function(t,n){s=a+(n+1)*i,e.printCenter(t,s,e.fontPkg("artist"))}));var o=s+i;return{top:a,bottom:o,height:o-a}}},{key:"clearTransform",value:function(){this.ctx.setTransform(1,0,0,1,0,0)}},{key:"setSkew",value:function(){this.theme.skewText&&this.ctx.transform(1,.06,.06,1,-20,0)}},{key:"printCenter",value:function(t,e,n){var a=this.ctx;a.save(),a.textAlign="center",n.draw(t,this.midX,e,this.maxPosterWidth,a,this.posterHeight),a.restore()}},{key:"printLeft",value:function(t,e,n){var a=this.ctx;a.save(),a.textAlign="left",n.draw(t,this.poster.maxLeft,e,this.maxPosterWidth,a,this.posterHeight),a.restore()}},{key:"printRight",value:function(t,e,n){this.ctx.save(),this.ctx.textAlign="right",n.draw(t,this.poster.maxRight,e,this.maxPosterWidth,this.ctx,this.posterHeight),this.ctx.restore()}},{key:"drawFestivalName",value:function(){var t=this.poster.canvasCtx,e=this.theme.nameFontPkg;t.save(),this.poster.drawPresentedBy&&(t.textBaseline="bottom",this.drawPresentedBy(0,this.festivalNameTop)),t.font=e.fontString(this.posterHeight),t.textBaseline="top",t.textAlign="center",t.strokeStyle="black",this.printCenter(this.poster.festivalName,this.festivalNameTop,e),t.restore()}},{key:"initDates",value:function(){var t=this;return this.poster.dates.map((function(e){return new yt(t.ctx,t.poster,e.date,t.fontPkg("date"))}))}},{key:"drawDates",value:function(){if(this.poster.drawDates){var t=this.initDates(),e=Object(c.a)(t,1)[0],n=this.theme.nameFontPkg.fontHeight(this.posterHeight)+this.festivalNameTop+e.metrics.height;e.draw(this.midX,n,"center")}}},{key:"drawPresentedBy",value:function(t,e){var n=new yt(this.ctx,this.poster,this.poster.presentedByText,this.theme.nameFontPkg);n.scale=.2,n.draw(t,e)}},{key:"poster",set:function(t){this._poster=t},get:function(){if(!this._poster)throw new Error("Expected poster to be set before drawing");return this._poster}},{key:"ctx",get:function(){return this.poster.canvasCtx}},{key:"theme",get:function(){return this.poster.theme}},{key:"midX",get:function(){return Math.floor(this.posterWidth/2)}},{key:"midY",get:function(){return Math.floor(this.posterHeight/2)}},{key:"posterWidth",get:function(){return this.poster.w}},{key:"maxPosterWidth",get:function(){return this.posterWidth-2*this.sideMargin}},{key:"posterHeight",get:function(){return this.poster.h}},{key:"maxPosterHeight",get:function(){return this.posterHeight}},{key:"sideMargin",get:function(){return Math.ceil(this.theme.sideMarginRatio*this.posterWidth)}},{key:"festivalNameTop",get:function(){return Math.floor(this.theme.festivalNameTopRatio*this.posterHeight)}},{key:"headlinersLine1",get:function(){var t=this.poster.getHeadlinersList(0);return 0===t.length?"":t[0]}},{key:"headlinersLine2",get:function(){var t=this.poster.getHeadlinersList(1);return 0===t.length?"":t[0]}},{key:"headlinersLine3",get:function(){var t=this.poster.getHeadlinersList(2);return 0===t.length?"":t[0]}},{key:"artistTop",get:function(){return this.posterHeight*this.theme.artistTopRatio}}]),t}(),wt=function(t){function e(){var t,n;Object(b.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(t=Object(v.a)(e)).call.apply(t,[this].concat(r)))).dateCount=1,n.headlinerLineCount=0,n}return Object(g.a)(e,t),e}(kt),xt=function(t){function e(){var t,n;Object(b.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(t=Object(v.a)(e)).call.apply(t,[this].concat(r)))).dateCount=1,n.headlinerLineCount=1,n.textScaleDelta=.9,n.currentArtistFontSize=0,n}return Object(g.a)(e,t),Object(y.a)(e,[{key:"setArtistFont",value:function(){var t=this.theme.artistFontPkg;this.currentArtistFontSize=t.fontHeight(this.posterHeight),this.ctx.font=this.theme.artistFontPkg.fontString(this.posterHeight)}},{key:"scaleDownArtistFont",value:function(){var t=this.theme.artistFontPkg;this.currentArtistFontSize=this.currentArtistFontSize*this.textScaleDelta,this.ctx.font="".concat(this.currentArtistFontSize,"px ").concat(t.fontType)}},{key:"setHeadlinerFont",value:function(){this.ctx.font=this.theme.artistFontPkg.fontString(this.posterHeight,2)}},{key:"artistLines",value:function(){var t=[],e=this.poster,n=this.fontPkg("artist");this.setArtistFont();var a="",r=!0,i=!1,s=void 0;try{for(var o,c=this.artistNames[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var u=o.value;this.calculateTextWidth(n,a,u)>this.maxPosterWidth?(t.push(this.cutTrailingChar(a)),a=u+e.artistSeperator,this.scaleDownArtistFont()):a=a+u+e.artistSeperator}}catch(l){i=!0,s=l}finally{try{r||null==c.return||c.return()}finally{if(i)throw s}}return""!==a&&t.push(this.cutTrailingChar(a)),t}},{key:"drawArtistBlock",value:function(t){var e=this,n=this.ctx;n.save(),n.textBaseline="bottom";var a=this.theme.artistFontPkg,r=a.lineHeight(this.posterHeight),i=t||this.artistTop,s=this.artistLines(),o=i,c=this.headlinersLine1;return this.setHeadlinerFont(),this.printLeft(c,o,a),this.setArtistFont(),this.printRight("FRIDAY",o,this.theme.artistFontPkg),s.forEach((function(t,n){o+=r,e.printLeft(t,o,a),e.scaleDownArtistFont()})),n.restore(),{bottom:0,top:i,height:0}}},{key:"artistNames",get:function(){return this.poster.artistNames}}]),e}(kt),Et=function(t){function e(){var t,n;Object(b.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(m.a)(this,(t=Object(v.a)(e)).call.apply(t,[this].concat(r)))).dateCount=3,n.headlinerLineCount=0,n}return Object(g.a)(e,t),Object(y.a)(e,[{key:"artistFont",value:function(){this.ctx.font=this.theme.artistFontPkg.fontString(this.posterHeight)}},{key:"drawArtistBlock",value:function(t){var e=this,n=this.initDates(),a=this.artistLines(),r=Math.ceil(a.length/3),i=a.slice(0,r),s=a.slice(r,2*r),o=a.slice(2*r),c=this.ctx,u=this.theme.artistFontPkg;c.save(),this.artistFont(),c.textBaseline="top";var l=u.lineHeight(this.posterHeight),h=t||this.artistTop,f=h;n.forEach((function(t){return t.scale=2}));var d=n[0].lineHeight,p=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.poster.showDates?(a?n[t].drawRight(f):n[t].drawLeft(f),f+=d):f+=d};return p(0),i.forEach((function(t,n){e.printLeft(t,f,u),f+=l})),p(1,!0),s.forEach((function(t,n){e.printRight(t,f,u),f+=l})),p(2),o.forEach((function(t){e.printLeft(t,f,u),f+=l})),c.restore(),{top:h,bottom:f+l,height:f+l-h}}},{key:"drawDates",value:function(){}}]),e}(kt),Ot=function(){var t=tt((function(t){return t.poster.layoutType}));return Object(r.useMemo)((function(){switch(t){case"basic":return new wt;case"weekend":return new Et;case"coachella":return new xt;default:throw new x("Invalid theme ".concat(t))}}),[t])},jt=n(43),St=n.n(jt),At=function(t){function e(){return Object(b.a)(this,e),Object(m.a)(this,Object(v.a)(e).apply(this,arguments))}return Object(g.a)(e,t),e}(function(){function t(e,n,a){Object(b.a)(this,t),this.ps=e,this.theme=n,this.layout=a,this.canvas=void 0,this.canvasCtx=void 0,this._w=0,this._h=0,this.img=void 0,this._drawBackground=!0,this.festivalNameCase="upper",this.artistCase="upper"}return Object(y.a)(t,[{key:"setPosterSize",value:function(t,e){this._w=Math.floor(t),this._h=Math.floor(e)}},{key:"getHeadlinersList",value:function(t){return this.ps.headliners[t]}},{key:"load",value:function(t,e){var n,a,r;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new St.a(this.artistFontPkg.fontType),a=new St.a(this.festivalNameFontPkg.fontType),r=[n.load(),a.load()],e&&r.push(this.loadImage()),t.next=6,p.a.awrap(this.loadImage());case 6:return t.prev=6,t.next=9,p.a.awrap(Promise.all(r));case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(6),console.error(t.t0);case 14:case"end":return t.stop()}}),null,this,[[6,11]])}},{key:"draw",value:function(e){var n,a=arguments;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],et(e,this.w,this.h),r.next=4,p.a.awrap(this.load(e,n));case 4:return this._drawBackground=n,this.canvas=e,this.canvasCtx=t.getContext(this.canvas),this.layout.poster=this,r.next=10,p.a.awrap(this._draw());case 10:case"end":return r.stop()}}),null,this)}},{key:"_draw",value:function(){var t,e,n,a,r,i,s,o=arguments;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{},e=t.drawBackground,n=void 0===e||e,a=t.drawArtistBlock,r=void 0===a||a,i=t.drawFestivalName,s=void 0===i||i,this.clear(),!n||!this._drawBackground){c.next=5;break}return c.next=5,p.a.awrap(this.drawBackground(this.canvas));case 5:if(s&&this.layout.drawFestivalName(),!r){c.next=9;break}return c.next=9,p.a.awrap(this.drawArtistBlock());case 9:this.showDates&&this.layout.drawDates();case 10:case"end":return c.stop()}}),null,this)}},{key:"drawArtistBlock",value:function(){var t,e,n,a;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=this.layout.drawArtistBlock(),e=t.bottom,n=this.layout.maxPosterHeight,!(e<=n)){r.next=4;break}return r.abrupt("return");case 4:return a=this.layout.artistTop-(e-n),r.next=7,p.a.awrap(this._draw({drawArtistBlock:!1}));case 7:this.layout.drawArtistBlock(a);case 8:case"end":return r.stop()}}),null,this)}},{key:"clear",value:function(){this.canvasCtx.clearRect(0,0,this.w,this.h)}},{key:"drawMultiCanvas",value:function(t,e){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(et(t,this.w,this.h),!e){n.next=4;break}return n.next=4,p.a.awrap(this.drawBackground(e));case 4:return n.next=6,p.a.awrap(this.draw(t,!1));case 6:return n.abrupt("return");case 7:case"end":return n.stop()}}),null,this)}},{key:"loadImage",value:function(t,e){var n=this;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return this.img=new Image(t,e),a.abrupt("return",new Promise((function(t){n.img.onload=function(){t()},n.img.src=n.theme.backgroundImage})));case 2:case"end":return a.stop()}}),null,this)}},{key:"drawBackground",value:function(e){var n,a;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return et(e,this.w,this.h),r.next=3,p.a.awrap(this.loadImage());case 3:n=this.img.naturalWidth,a=this.img.naturalHeight,t.getContext(e).drawImage(this.img,0,0,n,a,0,0,this.w,this.h);case 7:case"end":return r.stop()}}),null,this)}},{key:"artistFontPkg",get:function(){return this.theme.artistFontPkg}},{key:"festivalNameFontPkg",get:function(){return this.theme.nameFontPkg}},{key:"drawDates",get:function(){return this.ps.showDates}},{key:"dates",get:function(){return[this.ps.date1,this.ps.date2,this.ps.date3]}},{key:"w",get:function(){return this._w}},{key:"h",get:function(){return this._h}},{key:"presentedByText",get:function(){return this.ps.presentedBy}},{key:"drawPresentedBy",get:function(){return this.ps.showPresentedBy}},{key:"artistSeperator",get:function(){return String.fromCharCode(8226)}},{key:"festivalName",get:function(){return"upper"===this.festivalNameCase?this.ps.festivalName.toUpperCase():this.ps.festivalName}},{key:"artistNames",get:function(){var t=this;return this.ps.artists.filter((function(e){return e.isSelected&&!t.allHeadliners.includes(e.data.name)})).map((function(e){var n=e.data.name;return"upper"===t.artistCase&&(n=n.toUpperCase()),n}))}},{key:"allHeadliners",get:function(){return this.ps.headliners.flat()}},{key:"maxLeft",get:function(){return this.theme.sideMarginRatio*this.h}},{key:"maxRight",get:function(){return this.w-this.theme.sideMarginRatio*this.h}},{key:"showDates",get:function(){return this.ps.showDates}}],[{key:"getContext",value:function(t){var e=t.getContext("2d");if(!e)throw new x("Expected canvas context");return e}}]),t}()),Ct=function(){var t=function(){var t=tt((function(t){return t.poster.themeType}));return Object(r.useMemo)((function(){switch(t){case"punk":return new mt;case"rock":return new vt;case"desert":return new pt;case"galaxy":return new gt;case"test":return new bt;default:throw new x("Invalid theme ".concat(t))}}),[t])}(),e=Ot(),n=tt((function(t){return t.poster}));return Object(r.useMemo)((function(){return new At(n,t,e)}),[e,n,t])},Pt=n(101),Rt=[4,5],Tt=function(t){return t*(Rt[1]/Rt[0])},Nt=function(t){var e=t.parentDomRect,n=Ct(),a=Object(r.useState)(""),s=Object(c.a)(a,2),o=s[0],u=s[1],l=Object(r.useState)(0),h=Object(c.a)(l,2),f=h[0],d=h[1],m=Object(r.useState)(0),v=Object(c.a)(m,2),g=v[0],b=v[1],y=Object(r.useState)(!1),k=Object(c.a)(y,2),w=k[0],x=k[1],E=Object(r.useRef)(null),O=Object(r.useRef)(null),j=function(t){if(!t)return{w:0,h:0};for(var e,n=t.width,a=Tt(n);a>=(e=t.top,document.documentElement.clientHeight-e);)a=Tt(n-=5);return{w:n=Math.floor(n),h:a=Math.floor(a)}}(e),S=j.w,A=j.h,C=n.theme.backgroundImage;n.setPosterSize(S,A);var P=Object(r.useCallback)((function(){return C!==o||f!==S||g!==A}),[C,A,S,o,g,f]),R=Object(r.useCallback)((function(){return 0!==S&&0!==A}),[A,S]);Object(r.useEffect)((function(){R()&&function(){var t,e,a;p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=E.current){r.next=3;break}throw new Error("Unable to retreive poster canvas element");case 3:if(e=O.current){r.next=6;break}throw new Error("Unable to retreive poster background canvas element");case 6:return(a=P())&&x(!0),r.next=10,p.a.awrap(n.drawMultiCanvas(t,a?e:void 0));case 10:x(!1),u(n.theme.backgroundImage),d(n.w),b(n.h);case 14:case"end":return r.stop()}}))}()}),[R,P,n]);return i.a.createElement(i.a.Fragment,null,w&&i.a.createElement(Pt.a,{style:{width:"3rem",height:"3rem",zIndex:99}}),i.a.createElement("canvas",{id:"poster-bg",ref:O,style:{position:"absolute"}},"Poster BackGround"),i.a.createElement("canvas",{ref:E,id:"poster-canvas",style:{position:"absolute"}},"Festival Poster Viewer"))},Ft=n(106),It=n(102),Ht=n(103),Bt=n(104),Lt=function(t,e,n){var a=Object(r.useState)(e),i=Object(c.a)(a,2),s=i[0],o=i[1];return[s,{options:t,selected:s,handleChange:function(t){o(t),n&&n(t)}}]},Dt=function(t){var e=t.options,n=t.handleChange,a=t.selected,r=t.labelText,s=e.map((function(t){return i.a.createElement("option",{key:t.value,value:t.value},t.text)}));return i.a.createElement(It.a,null,r&&i.a.createElement(Ht.a,null,r),i.a.createElement(Bt.a,{type:"select",value:a,onChange:function(t){n&&n(t.target.value)}},s))},_t=n(25),Mt=n(105),zt=function(t){var e=t.children,n=Object(_t.a)(t,["children"]),a=n.color?n.color:"primary",r=n.size?n.size:"sm";return i.a.createElement(Mt.a,Object.assign({color:a,size:r,onClick:function(t){var e;t.stopPropagation(),null===(e=n.onClick)||void 0===e||e.call(n,t)}},n),e)},Ut=[{text:"Desert",value:"desert"},{text:"Punk",value:"punk"},{text:"Rock",value:"rock"},{text:"Galaxy",value:"galaxy"},{text:"TEST",value:"test"}],Wt=[{text:"Basic",value:"basic"},{text:"Weekend",value:"weekend"},{text:"Coachella",value:"coachella"}],Yt=function(){var t=Object(q.b)(),e=tt((function(t){return t.poster.themeType})),n=tt((function(t){return t.poster.layoutType})),a=Lt(Ut,e,(function(e){t(B(e))})),s=Object(c.a)(a,2)[1],o=Lt(Wt,n,(function(e){t(D(e))})),u=Object(c.a)(o,2)[1],l=function(){var t=Ct();return Object(r.useCallback)((function(){var e,n,a;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=document.createElement("canvas"),t.setPosterSize(1600,2e3),r.next=4,p.a.awrap(t.draw(e));case 4:n=e.toDataURL("png",1),null===(a=window.open("_blank"))||void 0===a||a.document.write("<img src=".concat(n,"></img>"));case 7:case"end":return r.stop()}}))}),[t])}();return i.a.createElement("div",{className:"options mb-2"},i.a.createElement(Ft.a,null,i.a.createElement(h.a,{form:!0},i.a.createElement(f.a,{md:6,xs:6},i.a.createElement(Dt,Object.assign({labelText:"Theme"},s))),i.a.createElement(f.a,{md:6,xs:6},i.a.createElement(Dt,Object.assign({labelText:"Text Layout"},u))),i.a.createElement(f.a,{md:6,xs:6}))),i.a.createElement(zt,{color:"warning",onClick:function(){return l()}},"Create Image"))},Xt=(n(86),n(114)),Vt=window.location.href,Kt="https://accounts.spotify.com/authorize",Gt="access_token",Jt="token_type",Zt="expires_in",$t={client_id:"f775b626d4784dfba4491742d5453d55",response_type:"token",redirect_uri:Vt,scope:"user-top-read"};function qt(){for(var t=[],e=0,n=Object.entries($t);e<n.length;e++){var a=n[e],r=Object(c.a)(a,2),i=r[0],s=r[1];t.push("".concat(i,"=").concat(s))}var o=t.join("&");return"".concat(Kt,"?").concat(o)}function Qt(){if(a)return{status:"AUTHORIZED",data:a};var t={},e=window.location.href.split("#");if(2!==e.length)return{status:"NOT_AUTHORIZED"};var n=e[1].split("&"),r=!0,i=!1,s=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var l=o.value.split("="),h=Object(c.a)(l,2),f=h[0],d=h[1];t[f]=d}}catch(m){i=!0,s=m}finally{try{r||null==u.return||u.return()}finally{if(i)throw s}}if(t.hasOwnProperty("error"))return{status:"ACCESS_DENIED"};var p="";return t.hasOwnProperty(Gt)||(p="Hash fragment does not contain field: ".concat(Gt)),t.hasOwnProperty(Zt)||(p="Hash fragment does not contain field: ".concat(Zt)),t.hasOwnProperty(Jt)||(p="Hash fragment does not contain field: ".concat(Jt)),""!==p?{status:"ERROR",error:p}:{status:"AUTHORIZED",data:t}}var te=function(){return i.a.createElement("div",{className:"h-100 d-flex justify-content-center align-items-center"},i.a.createElement("a",{className:"btn btn-success",role:"button",href:qt()},"Authorize Spotify"))};function ee(){var t=function(){var t=Object(r.useState)([0,0]),e=Object(c.a)(t,2),n=e[0],a=e[1];return Object(r.useLayoutEffect)((function(){function t(){a([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",t),t(),function(){return window.removeEventListener("resize",t)}}),[]),n}(),e=Object(c.a)(t,2),n=e[0],a=e[1],i=Object(r.useState)(void 0),s=Object(c.a)(i,2),o=s[0],u=s[1],l=Object(r.useRef)(null),h=l.current;return Object(r.useEffect)((function(){var t=null===h||void 0===h?void 0:h.getBoundingClientRect();u(t)}),[h,n,a]),[o,l]}var ne=function(){return Math.floor(Date.now()/1e3)},ae=function(){var t=tt((function(t){return t.system.spotifyAccessToken})),e=tt((function(t){return t.system.spotifyAccessTokenExpire}));if(""===t&&""===e)return{status:"NONE"};if(""===t||""===e)throw new Error("Spotify access token/expire in invalid state");return parseInt(e,10)<ne()?{status:"EXPIRED"}:{status:"VALID",accessToken:t}},re=(n(87),function(t){var e=t.children,n=t.currentPage;return i.a.createElement(i.a.Fragment,null,i.a.Children.map(e,(function(t,e){return i.a.createElement("div",{className:"".concat(e!==n&&"hidden")},t)})))}),ie=n(121),se=n(109),oe=n(110),ce=n(111),ue=function(t){var e=t.children,n=t.active,a=t.toggle,r=Object(_t.a)(t,["children","active","toggle"]),s=r.groupStatePkg,o=r.currentPage,c=r.submitOptions,u=r.pageHeaders,l=i.a.Children.count(e)-1,h=u[o];return i.a.createElement("div",null,i.a.createElement(ie.a,{scrollable:!0,size:"lg",isOpen:n},i.a.createElement(se.a,{toggle:a},h),i.a.createElement(oe.a,null,i.a.createElement(re,r,e)),i.a.createElement(ce.a,null,o>0&&i.a.createElement(Mt.a,{color:"secondary",onClick:r.onPrevPage},"Previous"),o<l&&i.a.createElement(Mt.a,{color:"primary",onClick:r.onNextPage},"Next"),o===l&&(Array.isArray(c)?c:[c]).map((function(t){return i.a.createElement(Mt.a,{color:t.color||"success",onClick:function(){t.submitFN(s.state),a()}},t.text)})),i.a.createElement(Mt.a,{color:"danger",onClick:function(){return a()}},"Cancel"))))},le=function(t,e,n){var a=function(t,e,n){var a=Object(r.useState)(0),i=Object(c.a)(a,2),s=i[0],o=i[1],u=Object(r.useState)(n),l=Object(c.a)(u,2),h=l[0],f=l[1],d=Object(r.useMemo)((function(){return t}),[]),p=Object(r.useCallback)((function(t){f(Object(j.a)((function(e){Object.assign(e,t)})))}),[]),m=Object(r.useCallback)((function(){o(s+1)}),[s]),v=Object(r.useCallback)((function(){0!==s&&o(s-1)}),[s]),g={state:h,mergeState:p};return[g,{groupStatePkg:g,pageHeaders:d,currentPage:s,onNextPage:m,onPrevPage:v,submitOptions:e}]}(t,e,n),i=Object(c.a)(a,2),s=i[0],o=i[1],u=Object(r.useState)(!1),l=Object(c.a)(u,2),h=l[0],f=l[1],d=Object(r.useCallback)((function(){f((function(t){return!t}))}),[]);return[s,Object(T.a)({},o,{toggle:d,active:h}),d]},he=n(26),fe="https://api.spotify.com",de="v1",pe=function(){function t(e){Object(b.a)(this,t),this.apiKey=e}return Object(y.a)(t,[{key:"getPlaylistArtists",value:function(t){var e;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.a.awrap(this.getPlaylistTracks(t));case 2:if(!((e=n.sent)instanceof x)){n.next=5;break}return n.abrupt("return",e);case 5:return n.abrupt("return",Ee(e));case 6:case"end":return n.stop()}}),null,this)}},{key:"noAuthAPICall",value:function(t){var e,n;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p.a.awrap(fetch(t));case 3:return e=a.sent,a.next=6,p.a.awrap(be(e,t));case 6:return n=a.sent,a.abrupt("return",n);case 10:return a.prev=10,a.t0=a.catch(0),a.abrupt("return",a.t0);case 13:case"end":return a.stop()}}),null,null,[[0,10]])}}]),t}(),me=function(t){function e(){return Object(b.a)(this,e),Object(m.a)(this,Object(v.a)(e).apply(this,arguments))}return Object(g.a)(e,t),Object(y.a)(e,[{key:"getPlaylists",value:function(){return t=this.apiKey,p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",we(t,["me","playlists"]));case 1:case"end":return e.stop()}}));var t}},{key:"getPlaylistTracks",value:function(t){return function(t,e){var n;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,p.a.awrap(we(t,["playlists",e,"tracks"]));case 2:if(!((n=a.sent)instanceof x)){a.next=5;break}return a.abrupt("return",n);case 5:return a.abrupt("return",n.map((function(t){return t.track})));case 6:case"end":return a.stop()}}))}(this.apiKey,t)}},{key:"me",value:function(){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",xe(this.apiKey));case 1:case"end":return t.stop()}}),null,this)}},{key:"topArtists",value:function(){var t,e,n,a,r,i,s,o,c=arguments;return p.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},e=t.limit,n=void 0===e?"50":e,a=t.offset,r=void 0===a?"0":a,i=t.time_range,s=void 0===i?"medium_term":i,u.next=3,p.a.awrap(we(this.apiKey,["me","top","artists"],{limit:n,offset:r,time_range:s}));case 3:return o=u.sent,u.abrupt("return",o);case 5:case"end":return u.stop()}}),null,this)}}]),e}(pe),ve=function(t){function e(){return Object(b.a)(this,e),Object(m.a)(this,Object(v.a)(e).apply(this,arguments))}return Object(g.a)(e,t),Object(y.a)(e,[{key:"getPlaylists",value:function(){var t;return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ge("users",this.apiKey,"playlists"),e.next=3,p.a.awrap(this.noAuthAPICall(t));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),null,this)}},{key:"getPlaylistTracks",value:function(t){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=ge("playlists",this.apiKey,"tracks"),t.next=3,p.a.awrap(this.noAuthAPICall(e));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),null,this)}},{key:"me",value:function(){var t;return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ge("users",this.apiKey),e.next=3,p.a.awrap(this.noAuthAPICall(t));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),null,this)}}]),e}(pe);function ge(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var a=[de].concat(e).join("/");return new URL(a,fe).href}function be(t,e){var n;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.ok){a.next=4;break}if(401!==t.status){a.next=3;break}return a.abrupt("return",new x("Fetch for URL ".concat(e," returned not ok status.  Status: ").concat(t.status),"NoSpotifyAccess"));case 3:return a.abrupt("return",new x("Fetch for URL ".concat(e," returned not ok status.  Status: ").concat(t.status),"NoSpotifyAccess"));case 4:if(200===t.status){a.next=6;break}return a.abrupt("return",new x("Fetch for URL ".concat(e," returned a status of ").concat(t.status),"NoSpotifyAccess"));case 6:return a.prev=6,a.next=9,p.a.awrap(t.json());case 9:return n=a.sent,a.abrupt("return",n);case 13:return a.prev=13,a.t0=a.catch(6),a.abrupt("return",a.t0);case 16:case"end":return a.stop()}}),null,null,[[6,13]])}function ye(t,e){var n,a;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n={Authorization:"Bearer ".concat(t)},r.prev=1,r.next=4,p.a.awrap(fetch(e,{headers:n}));case 4:return a=r.sent,r.abrupt("return",be(a,e));case 8:return r.prev=8,r.t0=r.catch(1),r.abrupt("return",r.t0);case 11:case"end":return r.stop()}}),null,null,[[1,8]])}function ke(t){if(!t)return"";var e=new URLSearchParams;for(var n in t)e.append(n,t[n]);return e.toString()}function we(t,e,n){var a,r,i;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return a=ke(n),r=ge.apply(void 0,Object(he.a)(e).concat(["?".concat(a)])),s.next=4,p.a.awrap(ye(t,r));case 4:if(!((i=s.sent)instanceof x)){s.next=7;break}return s.abrupt("return",i);case 7:if(i.hasOwnProperty("items")){s.next=9;break}throw new x("Returned paging object does not contain items field.  Url: ".concat(r));case 9:return s.abrupt("return",i.items);case 10:case"end":return s.stop()}}))}function xe(t){var e,n;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e=ge("me"),a.next=3,p.a.awrap(ye(t,e));case 3:return n=a.sent,a.abrupt("return",n);case 5:case"end":return a.stop()}}))}function Ee(t){var e=new Set;return t.forEach((function(t){e.add(t.artists[0].name)})),Object(he.a)(e)}var Oe=n(112),je=n(113),Se=n(124);n(95);function Ae(t,e,n){t.preventDefault(),n(e)}var Ce=function(t){var e=t.rowNumber,n=t.disableActions,a=t.item,s=t.isEditing,o=t.setIsEditing,u=t.renderData,l=Object(_t.a)(t,["rowNumber","disableActions","item","isEditing","setIsEditing","renderData"]),h=Object(r.useState)(a.data),f=Object(c.a)(h,2),d=f[0],p=f[1],m=l.handleRemove,v=l.handleEdit,g=l.handleSelectionChange,b=l.canEditGlobal&&a.canEdit&&v,y=!(!l.canRemove||!m),k=!(!l.canSelect||void 0===g),w=!!a.isSelected;return s?i.a.createElement(Oe.a,null,i.a.createElement(je.a,null,i.a.createElement(Bt.a,{value:d,style:{display:"inline"},onChange:function(t){p(t.target.value)}}),i.a.createElement(Se.a,{addonType:"append"},i.a.createElement(zt,{onClick:function(t){if(!v)throw Error("Expected handleEdit to exist by this point");Ae(t,Ne(a,{data:d}),v),p(""),o(!1)}},"Save")),i.a.createElement(Se.a,{addonType:"append"},i.a.createElement(zt,{color:"danger",onClick:function(t){p(""),o(!1)}},"X")))):function(){var t=k&&w;return i.a.createElement(Oe.a,{key:a.id,action:k,active:t,className:"noselect d-flex justify-content-between align-items-center py-1",onClick:function(t){var e;return null===(e=l.handleSelectionChange)||void 0===e?void 0:e.call(l,a)}},"number"===typeof e&&"".concat(e+1,". "),u(a.data),i.a.createElement(Xt.a,null,b&&v&&i.a.createElement(zt,{disabled:n,onClick:function(t){return o(!0)}},"Edit"),y&&m&&i.a.createElement(zt,{disabled:n,onClick:function(t){Ae(t,a,m)}},"Remove")),t?"\u2705":k?"\u274c":"")}()},Pe=n(115),Re=-1,Te=function(){return++Re};function Ne(t,e){return Object(T.a)({id:Te()},t,{},e)}function Fe(t,e){var n=Object(r.useState)([]),a=Object(c.a)(n,2),i=a[0],s=a[1];return[i,Object(r.useCallback)((function(t){var e=t.map((function(t){return Ne({data:t,isSelected:!0,canEdit:!1,userAdded:!1})}));s(e)}),[]),Ie(s,t,e)]}function Ie(t,e,n){return{handleRemove:function(n){var a;t((function(t){return t.filter((function(t){return t.id!==n.id}))})),null===e||void 0===e||null===(a=e.handleRemove)||void 0===a||a.call(e,n)},handleAddRow:function(a){var r,i,s=(null===n||void 0===n?void 0:null===(r=n.addRow)||void 0===r?void 0:r.call(n,a))||a;t((function(t){return[].concat(Object(he.a)(t),[s])})),null===e||void 0===e||null===(i=e.handleAddRow)||void 0===i||i.call(e,s)},handleEdit:function(n){var a;t((function(t){var e=Object(he.a)(t),a=e.find((function(t){return t.id===n.id}));if(!a)throw new Error("Could not find edited item: ".concat(JSON.stringify(n)));return a.data=n.data,e})),null===e||void 0===e||null===(a=e.handleEdit)||void 0===a||a.call(e,n)},handleSelectionChange:function(n){t((function(t){return Object(j.a)(t,(function(t){var a,r=t.findIndex((function(t){return t.id===n.id}));t[r].isSelected=!n.isSelected,null===e||void 0===e||null===(a=e.handleSelectionChange)||void 0===a||a.call(e,t[r])}))}))},handleSelectAll:function(){t((function(t){var e=t.map((function(t){return Object(T.a)({},t,{isSelected:!0})})),a=null===n||void 0===n?void 0:n.selectAll;return a&&(e=a(e)),e}))},handleClear:function(){t((function(t){var e=t.map((function(t){return Object(T.a)({},t,{isSelected:!1})})),a=null===n||void 0===n?void 0:n.clear;return a&&(e=a(e)),e}))}}}var He=function(t){var e=Object(r.useState)(!1),n=Object(c.a)(e,2),a=n[0],s=n[1],o=Object(r.useState)(""),u=Object(c.a)(o,2),l=u[0],h=u[1],f=Object(r.useState)(!1),d=Object(c.a)(f,2),p=d[0],m=d[1],v=t.items,g=t.canSelect&&t.canSelectAll&&t.handleSelectAll,b=t.canSelect&&t.canSelectAll&&t.handleClear,y=function(){var e=t.handleAddRow,n=t.canAddRow;return e&&n?a?i.a.createElement("div",null,i.a.createElement(Oe.a,null,i.a.createElement(je.a,null,i.a.createElement(Bt.a,{value:l,onChange:function(t){return h(t.target.value)}}),i.a.createElement(Xt.a,null,i.a.createElement(zt,{onClick:function(){var t=Ne({data:l,userAdded:!0,isSelected:!1},{});s(!1),e(t),h("")}},"Save"),i.a.createElement(zt,{color:"danger",onClick:function(){s(!1),h("")}},"X"))))):i.a.createElement(Oe.a,null,i.a.createElement(zt,{block:!0,disabled:p,onClick:function(){return s(!0)}},"Add Row")):null},k=function(){return i.a.createElement("div",{className:"list__header",style:{display:"flex",justifyContent:"space-between"}},t.name?i.a.createElement("h3",null,t.name):null,function(){var e=null,n=null;return g&&(e=i.a.createElement(zt,{color:"success",onClick:function(e){var n;null===(n=t.handleSelectAll)||void 0===n||n.call(t)}},"Select All")),b&&(n=i.a.createElement(zt,{color:"warning",onClick:function(e){var n;null===(n=t.handleClear)||void 0===n||n.call(t)}},"Unselect All")),i.a.createElement("div",{className:"list__actions"},i.a.createElement(Xt.a,null,e,n))}())};return i.a.createElement("div",{className:"list"},function(){var e=v.map((function(e,n){var r=t.rowNumbers?n:void 0;return i.a.createElement(Ce,Object.assign({key:e.id,item:e,setIsEditing:m,isEditing:p,disableActions:a,rowNumber:r},t))}));return i.a.createElement("div",{className:"list"},k(),i.a.createElement(Pe.a,null,e,y()))}())},Be=function(){var t=Object(q.b)();return Object(r.useCallback)((function(e,n){n&&(e.type=n),t(P(e))}),[t])},Le=function(){var t=ae(),e=Be(),n="";"NONE"===t.status||"EXPIRED"===t.status?e(new x("Spotify Access token status not valid.  status: ".concat(t.status)),"NoSpotifyAccess"):n=t.accessToken;return Object(r.useMemo)((function(){return""===n?null:function(t){var e=t.authToken,n=t.userId;return e&&""!==e?new me(e):n&&""!==n?new ve(n):null}({authToken:n})}),[n])},De=function(t){var e=t.images[t.images.length-1].url;return i.a.createElement("span",null,i.a.createElement("img",{className:"",alt:t.name+" photo",src:e,style:{height:"50px",width:"50px",marginRight:"5px"}}),t.name)},_e=function(t){var e=t.timeRange,n=(t.children,t.groupStatePkg),a=function(t){var e=Le(),n=Be(),a=Object(r.useState)([]),i=Object(c.a)(a,2),s=i[0],o=i[1];return Object(r.useEffect)((function(){!function(){var a;p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(null===e||void 0===e?void 0:e.topArtists){r.next=2;break}return r.abrupt("return");case 2:return r.prev=2,r.next=5,p.a.awrap(e.topArtists({time_range:t}));case 5:if(!((a=r.sent)instanceof Error)){r.next=9;break}return n(a),r.abrupt("return");case 9:o(a),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),n(r.t0);case 15:case"end":return r.stop()}}),null,null,[[2,12]])}()}),[e,n,t]),s}(e),s=Fe(),o=Object(c.a)(s,3),u=o[0],l=o[1],h=o[2];return Object(r.useEffect)((function(){0!==a.length&&l(a)}),[a,l]),Object(r.useEffect)((function(){n.mergeState({artists:u})}),[n,u]),i.a.createElement("div",null,i.a.createElement(He,Object.assign({canSelect:!0,canSelectAll:!0,items:u},h,{renderData:De})))},Me=["playlist 1","playlist 2","playlist 3"],ze=function(t){t.groupStatePkg;var e=Fe(),n=Object(c.a)(e,3),a=n[0],s=n[1],o=n[2];return Object(r.useEffect)((function(){s(Me)}),[s]),i.a.createElement("div",null,i.a.createElement(He,Object.assign({items:a},o,{renderData:function(t){return t}})))},Ue=function(){var t="VALID"!==ae().status,e=Object(q.b)(),n=Object(r.useState)(""),a=Object(c.a)(n,2),s=a[0],o=a[1],u=le(["Select Artists"],[{text:"Replace Existing Artists",submitFN:function(t){var n=t.artists.filter((function(t){return t.isSelected}));e(L(n))}},{text:"Merge with Existing Artists",submitFN:function(t){var n=t.artists.filter((function(t){return t.isSelected}));e(_(n))}}],{artists:[]}),l=Object(c.a)(u,3),h=l[0],f=l[1],d=l[2],p=le(["Select a Playlist","Select Artists"],[{text:"Replace Existing Artists",submitFN:function(t){var n=t.artists.filter((function(t){return t.isSelected}));e(L(n))}},{text:"Merge with Existing Artists",submitFN:function(t){var n=t.artists.filter((function(t){return t.isSelected}));e(_(n))}}],{artists:[],selectedPlaylist:"",playlists:[]}),m=Object(c.a)(p,3),v=m[0],g=m[1],b=m[2];return i.a.createElement("div",null,t&&i.a.createElement(te,null),!t&&i.a.createElement("div",{className:"d-flex flex-column"},i.a.createElement(Mt.a,{className:"btn-success mx-1 my-1",onClick:function(){d(),o("long_term")}},"Import Your Top Artists (All Time)"),i.a.createElement(Mt.a,{className:"btn-success mx-1 my-1",onClick:function(){d(),o("medium_term")}},"Import Your Top Artists (6 Months)"),i.a.createElement(Mt.a,{className:"btn-success mx-1 my-1",onClick:function(){d(),o("short_term")}},"Import Your Top Artists (1 Month)"),i.a.createElement(Mt.a,{className:"btn-success mx-1 my-1",onClick:function(){b()}},"Import From a Playlist"),i.a.createElement(ue,f,i.a.createElement(_e,{groupStatePkg:h,timeRange:s})),i.a.createElement(ue,g,i.a.createElement(ze,{groupStatePkg:v}))))},We=(n(96),n(116)),Ye=function(t){var e=t.validations,n=t.changeHook,a=t.onResult,s=t.submittable,o=t.submitHook,u=t.submitText,l=void 0===u?"Submit":u,h=t.initialValue,f=void 0===h?"":h,d=t.debounceRate,p=void 0===d?300:d,m=Object(_t.a)(t,["validations","changeHook","onResult","submittable","submitHook","submitText","initialValue","debounceRate"]),v=Object(r.useState)(f),g=Object(c.a)(v,2),b=g[0],y=g[1],k=Object(r.useState)(!1),w=Object(c.a)(k,2),x=w[0],E=w[1],O=Object(r.useState)(""),j=Object(c.a)(O,2),S=j[0],A=j[1],C=e||[],P=Object(r.useCallback)(Object(N.debounce)((function(t){if(""===t)return E(!1),A(""),void(null===a||void 0===a||a(""));var n;Object(N.isUndefined)(e)?null===a||void 0===a||a(t):0!==e.length?(e.forEach((function(e){var a=e(t);if(!1===a.isValid)return E(!0),A(a.errorMsg||""),n=a,a})),n||(E(!1),A(""),null===a||void 0===a||a(t))):null===a||void 0===a||a(t)}),p),[].concat(Object(he.a)(C),[a])),R=function(){if(!x&&o){var t=o(b);if(!t.isValid)return E(!0),void A(t.errorMsg||"");y("")}},T=function(t){"Enter"===t.key&&""!==b&&R()};return i.a.createElement(It.a,null,i.a.createElement(je.a,null,i.a.createElement(Bt.a,Object.assign({className:"app-input",value:b},m,{invalid:x,onChange:function(t){return e=t.target.value,y(e),null===n||void 0===n||n(e),void(null===P||void 0===P||P(e));var e},onKeyPress:T})),s&&i.a.createElement(Se.a,{addonType:"append"},i.a.createElement(zt,{disabled:x||""===b,onClick:R},l)),x&&i.a.createElement(We.a,null,S)))},Xe=n(117),Ve=n(122),Ke=n(123),Ge=n(63),Je=n(64),Ze="ontouchstart"in window||navigator.msMaxTouchPoints>0,$e=function(t){var e=t.artistObj,n=t.rowIndex,a=t.moveItem,s=e.images[e.images.length-1].url,o=Object(q.b)(),u=Object(r.useRef)(null),l=Object(Ve.a)({item:{type:"ArtistListItem",rowIndex:n},collect:function(t){return{isDragging:t.isDragging()}},end:function(t,e){var n=e.getDropResult();if(n)n.rowIndex}}),h=Object(c.a)(l,2),f=h[0].isDragging,d=h[1],p=Object(Ke.a)({accept:"ArtistListItem",hover:function(t,e){if(u.current){var r=t.rowIndex,i=n;if(r!==i){var s=u.current.getBoundingClientRect(),o=(s.bottom-s.top)/2,c=e.getClientOffset().y-s.top;r<i&&c<o||r>i&&c>o||(a(r,i),t.rowIndex=i)}}},drop:function(t,e){return{rowIndex:n}},collect:function(t){return{isOver:!!t.isOver()}}}),m=Object(c.a)(p,2),v=m[0].isOver,g=m[1];v&&console.log("over");d(g(u));var b=Ze?null:u,y=Ze?u:null;return i.a.createElement("div",{ref:b,style:f&&!Ze?{opacity:0}:f&&Ze?{boxShadow:"box-shadow: 0px 0px 35px 0px rgba(0,0,0,0.75)"}:v?{cursor:"move"}:{}},i.a.createElement(Oe.a,{className:"px-0 py-0 bx-0 by-0 d-flex justify-content-between movable"},i.a.createElement("span",null,i.a.createElement("img",{className:"",alt:e.name+" photo",src:s,style:{height:"3rem",width:"3rem",marginRight:"5px"}}),e.name),!Ze&&i.a.createElement(Mt.a,{color:"danger",type:"button",class:"close","aria-label":"Close",onClick:function(){return o(U(e))}},i.a.createElement("span",{"aria-hidden":"true"},"\xd7")),Ze&&i.a.createElement("div",{ref:y,style:{fontSize:"2rem",paddingRight:".5rem"}},"\u2630")))},qe=function(){var t=tt((function(t){return t.poster.artists})),e=Object(q.b)(),n=function(t,n){return e(W({from:t,to:n}))};return i.a.createElement("div",null,i.a.createElement(Ye,{submittable:!0,submitText:"Add",submitHook:function(t){var n=Ne({data:{name:t,uri:t,images:[{url:ht.a}]},isSelected:!0,userAdded:!0,canEdit:!0});return e(X(n)),{isValid:!0}},placeholder:"Add Custom Artist"}),i.a.createElement(Xe.a,{backend:Ze?Je.a:Ge.a},i.a.createElement(Pe.a,null,t.map((function(t,e){return i.a.createElement($e,{artistObj:t.data,key:t.data.uri,rowIndex:e,moveItem:n})})))))},Qe=n(38),tn=function(){var t=Object(q.b)(),e=tt((function(t){return t.poster.presentedBy})),n=tt((function(t){return t.poster.showPresentedBy}));return i.a.createElement("div",null,i.a.createElement(It.a,{check:!0},i.a.createElement(Ht.a,{check:!0},i.a.createElement(Bt.a,{type:"checkbox",checked:n,onChange:function(){return t(z({showPresentedBy:!n}))}}),"Show Presented By")),n&&i.a.createElement(Ye,{initialValue:e,debounceRate:0,onResult:function(e){return t(z({presentedBy:e}))}}))},en=function(){var t=Ot().dateCount,e=tt((function(t){return t.poster})),n=e.showDates,a=e.date1,r=e.date2,s=e.date3,o=Object(q.b)(),c=function(t,e){return o(z(Object(Qe.a)({},t,{date:e})))};return i.a.createElement(Ft.a,null,i.a.createElement(It.a,{check:!0},i.a.createElement(Ht.a,{check:!0},i.a.createElement(Bt.a,{type:"checkbox",checked:n,onChange:function(){return o(z({showDates:!n}))}}),"Show Festival Dates")),n&&i.a.createElement(Ht.a,null,"Date One",i.a.createElement(Ye,{initialValue:a.date,onResult:function(t){return c("date1",t)},debounceRate:0})),n&&t>1&&i.a.createElement(Ht.a,null,"Date Two",i.a.createElement(Ye,{initialValue:r.date,onResult:function(t){return c("date2",t)},debounceRate:0})),n&&t>2&&i.a.createElement(Ht.a,null,"Date Three",i.a.createElement(Ye,{initialValue:s.date,onResult:function(t){return c("date3",t)},debounceRate:0})))},nn=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ht.a,null,"Headliner (Line 1)",i.a.createElement(an,{line:0,pos:0})))},an=function(t){var e=t.line,n=t.pos,a=tt((function(t){return t.poster.headliners[e][n]})),r=tt((function(t){return t.poster.artists})),s=Object(q.b)(),o=0===r.length;return i.a.createElement(Bt.a,{type:"select",disabled:!a&&o,value:a,onChange:function(t){return s(Y({line:e,pos:n,newHeadliner:t.target.value}))}},!a&&o&&i.a.createElement("option",{disabled:!0,selected:!0},"No Artists..."),!a&&!o&&i.a.createElement("option",{disabled:!0,selected:!0},"Select a Headliner"),r.map((function(t){return i.a.createElement("option",{value:t.data.name},t.data.name)})))},rn=function(){var t=Object(q.b)(),e=tt((function(t){return t.poster})).festivalName,n=Ot().headlinerLineCount;return i.a.createElement("div",null,i.a.createElement(tn,null),"Festival Name",i.a.createElement(Ye,{initialValue:e,onResult:function(e){return t(M(e))},placeholder:"Festival Name",debounceRate:0}),n>0&&i.a.createElement(nn,null),i.a.createElement(en,null))},sn=["Import Artists","Manage Artists","Advanced Options"],on=function(t){var e=t.onSelectChange,n=t.selectedId;return i.a.createElement(Xt.a,{toggle:!0,"aria-label":"Option Selection"},sn.map((function(t,a){return i.a.createElement(Mt.a,{className:"".concat((r=a,r===n?"btn-success btn-sm mb-1":"btn-sm mb-1")),onClick:function(){return e(a)}},t);var r})))},cn=function(){var t=tt((function(t){return t.sidenav.isOpen})),e=tt((function(t){return t.sidenav.selectedOption})),n=Object(q.b)(),a=t?300:0;return i.a.createElement("div",{className:"sidenav",style:{width:a}},i.a.createElement("a",{href:"#",className:"closebtn",onClick:function(){return n(Z())}},"\xd7"),i.a.createElement(on,{selectedId:e,onSelectChange:function(t){n(J(t))}}),0===e&&i.a.createElement(Ue,null),1===e&&i.a.createElement(qe,null),2===e&&i.a.createElement(rn,null))},un=function(){var t=ee(),e=Object(c.a)(t,2),n=e[0],a=e[1],r=Object(q.b)();return i.a.createElement("div",{className:"home h-100"},i.a.createElement(u.a,{className:"navbar navbar-expand-sm navbar-light bg-light py-0",style:{marginBottom:"10px"}},i.a.createElement(zt,{className:"mr-2",onClick:function(){return r(Z())}},"Options"),i.a.createElement("div",{className:"navbar-brand"},"Poster App"),null),i.a.createElement(cn,null),i.a.createElement(Yt,null),i.a.createElement("div",{ref:a,className:"h-100"},i.a.createElement(l.a,{className:"h-100"},i.a.createElement(h.a,{className:"h-100"},i.a.createElement(f.a,{className:"d-flex justify-content-center h-100"},i.a.createElement(Nt,{parentDomRect:n}))))))},ln=n(120),hn=function(){return i.a.createElement(ln.b,{to:"/"})},fn=function(){var t=Object(q.b)(),e=Qt();if("AUTHORIZED"!==e.status)return console.log("Non Authorized status: ".concat(e.status)),console.log(e.error),hn();if(!e.data)throw new Error("Received authorized status without data");var n=e.data,a=n.access_token,r=n.expires_in;return t(C({spotifyAccessToken:a,spotifyAccessTokenExpire:r})),hn()},dn=function(){var t=Object(q.b)(),e=Qt();if("AUTHORIZED"!==e.status);else{if(!e.data)throw new Error("Received authorized status without data");var n=e.data,a=n.access_token,r=n.expires_in,s=parseInt(r,10);if(isNaN(s))throw new Error("Spotify did not return a valid number ".concat(r));var o=ne()+s;window.location.hash="",t(C({spotifyAccessToken:a,spotifyAccessTokenExpire:o.toString()}))}return i.a.createElement("div",{className:"App"},i.a.createElement(ln.d,null,i.a.createElement(ln.c,{exact:!0,path:"/authenticate"},i.a.createElement(fn,null)),i.a.createElement(ln.c,{exact:!0,path:"/"},i.a.createElement(un,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var pn=window.localStorage.getItem("version");pn?parseInt(pn,10)<6&&(window.localStorage.clear(),window.localStorage.setItem("version",6..toString())):(window.localStorage.clear(),window.localStorage.setItem("version",6..toString()));var mn=window.localStorage.getItem("__REDUX_LOCAL_STORAGE_KEY"),vn=mn?JSON.parse(mn):void 0,gn=[function(t){return function(e){return function(n){var a=e(n),r=t.getState(),i=JSON.stringify(r);return window.localStorage.setItem("__REDUX_LOCAL_STORAGE_KEY",i),a}}}],bn=Object(O.a)({reducer:Q,preloadedState:vn,middleware:gn}),yn=function(t){var e=t.children,n=tt((function(t){return t.system.error})),a=Object(r.useState)(!1),s=Object(c.a)(a,2),o=s[0],u=s[1];if(!n.isError||!n.error)return o&&u(!o),i.a.createElement(i.a.Fragment,null,e);var l=n.error;if(l)switch(l.type){case"NoSpotifyAccess":o||u(!0),null;break;default:i.a.createElement("h3",null,"Error"),console.error(l)}return i.a.createElement(i.a.Fragment,null,e)};o.a.render(i.a.createElement(q.a,{store:bn},i.a.createElement(yn,null,i.a.createElement(ln.a,null,i.a.createElement(dn,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[67,1,2]]]);
//# sourceMappingURL=main.589501b2.chunk.js.map